#!/usr/bin/env php
<?php
require_once dirname(__FILE__) . '/../src/GitMigrate.php';

use PhillipsData\GitMigrate\GitMigrate;

$defaults = array(
    'items' => null,
    'dir' => null,
    'authors' => null,
    'url' => null,
    'javalib' => null
);
$opts = array_merge(
    $defaults,
    getopt(
        null,
        array(
            'items:',
            'dir:',
            'authors:',
            'url:',
            'javalib:',
            'sync::'
        )
    )
);

$items = array();
if (file_exists($opts['items'])) {
    $items = require $opts['items'];
}

$migrate = new GitMigrate(
    $opts['dir'],
    $opts['authors'],
    $opts['url'],
    $opts['javalib']
);
foreach ($items as $path => $item) {
    if (is_int($path)) {
        $path = null;
    }
    $migrate->process(
        $item,
        $path,
        array_key_exists('sync', $opts)
        ? 'sync'
        : 'clone'
    );
}
